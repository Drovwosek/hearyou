# JTBD Integration ‚Äî –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `core/jtbd_analyzer.py`

**–ö–ª–∞—Å—Å `JTBDAnalyzer`:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Claude Sonnet 4.5 –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã JTBD: Jobs, Pains, Gains, Context, Triggers
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON —Å —Ü–∏—Ç–∞—Ç–∞–º–∏ –∏ —É—Ä–æ–≤–Ω—è–º–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–∞–∫–µ—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Markdown

**–§—Ä–µ–π–º–≤–æ—Ä–∫ JTBD:**
- **Jobs** ‚Äî —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ/—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ/—Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **Pains** ‚Äî –±–æ–ª–∏, –ø—Ä–æ–±–ª–µ–º—ã, –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è (—Å severity)
- **Gains** ‚Äî –≤—ã–≥–æ–¥—ã, –∂–µ–ª–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (required/expected/desired/unexpected)
- **Context** ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç, —Å–∏—Ç—É–∞—Ü–∏—è (when/where/who/constraints)
- **Triggers** ‚Äî —Ç—Ä–∏–≥–≥–µ—Ä—ã, —á—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ä–∞–±–æ—Ç—É (event/problem/switching_moment)

### 2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ `packages/stt-service/app.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `JTBDAnalyzer`
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (—Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫)
- ‚úÖ –ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `analyze_jtbd=True` –≤ endpoints `/transcribe` –∏ `/complete-upload`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π JTBD –∞–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ JSON –ø–æ–ª–µ `jtbd`
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (92% ‚Üí "JTBD –∞–Ω–∞–ª–∏–∑...")
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤

**Workflow:**
1. –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ ‚Üí —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è (Yandex STT)
2. –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ (filler words, corrections)
3. **JTBD –∞–Ω–∞–ª–∏–∑** (–µ—Å–ª–∏ `analyze_jtbd=True`)
4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ JSON

### 3. –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**`packages/stt-service/requirements.txt`:**
```
anthropic>=0.39.0
```

### 4. –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **`JTBD_README.md`** ‚Äî –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—É—Å—Ç–∞–Ω–æ–≤–∫–∞, API, –ø—Ä–∏–º–µ—Ä—ã)
- **`JTBD_EXAMPLE.json`** ‚Äî –ø—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- **`JTBD_INTEGRATION.md`** ‚Äî –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

```bash
cd packages/stt-service
pip install -r requirements.txt
```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å API –∫–ª—é—á Claude:**

```bash
export ANTHROPIC_API_KEY="sk-ant-api03-..."
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å:**

```bash
cd packages/stt-service
python app.py
```

4. **–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ API:**

```bash
curl -X POST "http://localhost:8000/transcribe" \
  -F "file=@interview.mp3" \
  -F "analyze_jtbd=true"
```

5. **–ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```bash
curl "http://localhost:8000/result/{task_id}"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å:**

```json
{
  "text": "—Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è...",
  "jtbd": {
    "jobs": [...],
    "pains": [...],
    "gains": [...],
    "context": [...],
    "triggers": [...],
    "summary": "—Ä–µ–∑—é–º–µ...",
    "metadata": {...}
  }
}
```

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–°–º. [JTBD_EXAMPLE.json](./JTBD_EXAMPLE.json) –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞.

**–ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:**
- `text` ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞
- `quote` ‚Äî –ø—Ä—è–º–∞—è —Ü–∏—Ç–∞—Ç–∞ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
- `confidence` ‚Äî —É—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (high/medium/low)
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–æ–ª—è (type, severity, dimension)

**–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:**
- `model` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –º–æ–¥–µ–ª—å
- `total_elements` ‚Äî –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- `input_tokens` / `output_tokens` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –û—Ç–∫–ª—é—á–∏—Ç—å JTBD –∞–Ω–∞–ª–∏–∑

**–ß–µ—Ä–µ–∑ API:**

```bash
curl -X POST "http://localhost:8000/transcribe" \
  -F "file=@audio.mp3" \
  -F "analyze_jtbd=false"
```

**–í –∫–æ–¥–µ (app.py):**

```python
# –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: –µ—Å–ª–∏ API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä = None
# –ê–Ω–∞–ª–∏–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
```

### –ò–∑–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª—å Claude

```python
# –í app.py
jtbd_analyzer = JTBDAnalyzer(model="claude-3-5-sonnet-20241022")
```

### –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–∞

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –º–µ—Ç–æ–¥ `_build_prompt()` –≤ `core/jtbd_analyzer.py`:

```python
def _build_prompt(self, text: str) -> str:
    # –î–æ–±–∞–≤—å—Ç–µ domain-specific –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
    # –ò–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É JSON
    # –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∏–º–µ—Ä—ã (few-shot)
    ...
```

---

## üìä –°—Ç–æ–∏–º–æ—Å—Ç—å

**Claude Sonnet 4.5:**
- Input: $3 / 1M tokens
- Output: $15 / 1M tokens

**–ü—Ä–∏–º–µ—Ä –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ 1000 —Å–ª–æ–≤:**
- Input: ~1500 tokens (~$0.0045)
- Output: ~800 tokens (~$0.012)
- **–ò—Ç–æ–≥–æ: ~$0.017 –∑–∞ –∞–Ω–∞–ª–∏–∑**

–î–ª—è 100 —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π: ~$1.70

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### CLI —Ç–µ—Å—Ç

```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
echo "–ú–Ω–µ –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ —Ä–∞–±–æ—Ç—É, –Ω–æ –Ω–µ –∑–Ω–∞—é –∫–∞–∫ –ø–∏—Å–∞—Ç—å —Ä–µ–∑—é–º–µ." > test.txt

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑
python core/jtbd_analyzer.py test.txt
```

### Python —Ç–µ—Å—Ç

```python
from core.jtbd_analyzer import JTBDAnalyzer

analyzer = JTBDAnalyzer()
result = analyzer.analyze("–¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç...")

assert "jobs" in result
assert "pains" in result
assert result["metadata"]["total_elements"] > 0
```

### API —Ç–µ—Å—Ç

```bash
# 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
TASK_ID=$(curl -X POST "http://localhost:8000/transcribe" \
  -F "file=@test.mp3" \
  -F "analyze_jtbd=true" \
  | jq -r '.task_id')

# 2. –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
sleep 30

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
curl "http://localhost:8000/result/$TASK_ID" | jq '.jtbd.jobs'
```

---

## üêõ Troubleshooting

### 1. –û—à–∏–±–∫–∞ "ANTHROPIC_API_KEY –Ω–µ –Ω–∞–π–¥–µ–Ω"

**–†–µ—à–µ–Ω–∏–µ:**

```bash
export ANTHROPIC_API_KEY="sk-ant-api03-..."
```

–ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ `.env`:

```env
ANTHROPIC_API_KEY=sk-ant-api03-...
```

### 2. –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

**–°–∏–º–ø—Ç–æ–º:** –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç `JTBD Analyzer not initialized`

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `anthropic` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `pip list | grep anthropic`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á: `echo $ANTHROPIC_API_KEY`

### 3. –ü—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç JTBD

**–ü—Ä–∏—á–∏–Ω—ã:**
- –¢–µ–∫—Å—Ç —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π
- –ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ü–µ–ª—è—Ö/–ø—Ä–æ–±–ª–µ–º–∞—Ö
- Claude –Ω–µ —Å–º–æ–≥ –∏–∑–≤–ª–µ—á—å —ç–ª–µ–º–µ–Ω—Ç—ã

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ (—É—Ä–æ–≤–µ–Ω—å `DEBUG`)
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π —Ç–µ–∫—Å—Ç

### 4. JSON parse error

**–†–µ–¥–∫–∞—è –æ—à–∏–±–∫–∞:** Claude –≤–µ—Ä–Ω—É–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON

**–†–µ—à–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—ã—Ç–∞–µ—Ç—Å—è –∏–∑–≤–ª–µ—á—å JSON –∏–∑ markdown –±–ª–æ–∫–æ–≤. –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ–º–ø—Ç.

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- **JTBD Theory:** [jtbd.info](https://jtbd.info/)
- **Claude API Docs:** [docs.anthropic.com](https://docs.anthropic.com/)
- **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [JTBD_README.md](./JTBD_README.md)
- **–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:** [JTBD_EXAMPLE.json](./JTBD_EXAMPLE.json)

---

## üéØ Use Cases

1. **Customer Development** ‚Äî –∞–Ω–∞–ª–∏–∑ –∏–Ω—Ç–µ—Ä–≤—å—é –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≥–∏–ø–æ—Ç–µ–∑
2. **User Research** ‚Äî –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π –¥–ª—è –¥–∏–∑–∞–π–Ω–∞ —Ñ–∏—á
3. **Market Research** ‚Äî –≤—ã—è–≤–ª–µ–Ω–∏–µ –±–æ–ª–µ–π –∏ –≤—ã–≥–æ–¥ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏
4. **Sales Intelligence** ‚Äî –∞–Ω–∞–ª–∏–∑ –∑–≤–æ–Ω–∫–æ–≤ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π

---

## ‚ú® Next Steps (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

- [ ] –î–æ–±–∞–≤–∏—Ç—å UI –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ JTBD —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—É–±–∞–≥–µ–Ω—Ç)
- [ ] –°–æ–∑–¥–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏—é –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω—Ç–µ—Ä–≤—å—é
- [ ] –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –≤ PDF/Markdown
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏
- [ ] Few-shot –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∞–Ω–∞–ª–∏–∑–∞

---

**–°–æ–∑–¥–∞–Ω–æ:** 2026-02-28  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–ê–≤—Ç–æ—Ä:** AI Assistant (Claude Sonnet 4.5)
